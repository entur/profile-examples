<?xml version="1.0" encoding="UTF-8"?>
<PublicationDelivery version="1.08:NO-NeTEx-fares:1.0" xmlns="http://www.netex.org.uk/netex">
    <PublicationTimestamp>2018-09-04T12:00:00</PublicationTimestamp>
    <ParticipantRef>ENT</ParticipantRef>
    <dataObjects>

        <!-- Reference data START -->

        <ResourceFrame id="ENT:ResourceFrame:1" version="1">
            <organisations>
                <Authority id="ENT:Authority:ENT" version="1">
                    <Name>Entur School Transport Service Inc</Name>
                </Authority>
            </organisations>
        </ResourceFrame>

        <FareFrame id="ENT:FareFrame:1" version="1">
            
            <qualityStructureFactors>
                <QualityStructureFactor id="SKY:QualityStructureFactor:190" version="1">
                    <Name>190 validations per year</Name>
                    <Value>190</Value>
                </QualityStructureFactor>
                <QualityStructureFactor id="SKY:QualityStructureFactor:95" version="1">
                    <Name>95 validations per year</Name>
                    <Value>35</Value>
                </QualityStructureFactor>
            </qualityStructureFactors> 
            
            
            
            <validableElements>
                <ValidableElement id="ENT:ValidableElement:SingleTrip" version="1">
                    <Name>Enkelttur Entur</Name>
                </ValidableElement>
            </validableElements>


            <usageParameters>
                <UserProfile id="ENT:UserProfile:Pupil" version="1">
                    <Name lang="no">Skolelev</Name>
                    <ProofRequired>identityDocument</ProofRequired> <!-- Skolekort -->
                </UserProfile>
            </usageParameters>


            <fareProducts>
                <AmountOfPriceUnitProduct id="ENT:AmountOfPriceUnitProduct:SchoolCarnet" version="1">
                    <Name lang="no">Skolekort med fast antall reiser</Name>
                    <accessRightsInProduct>
                        <AccessRightInProductRef ref="ENT:ValidableElement:SingleTrip" version="1"/>
                    </accessRightsInProduct>
                </AmountOfPriceUnitProduct>
             </fareProducts>


            <salesOfferPackages>
                <SalesOfferPackage id="ENT:SalesOfferPackage:SchoolCarnet" version="1">
                    <Name lang="no">Skolekort Bergen</Name>
                    <salesOfferPackageElements>
                        <SalesOfferPackageElement id="ENT:SalesOfferPackageElement:SchoolCarnet" version="1" order="1">
                            <Name lang="no">Skolekort</Name>
                            <AmountOfPriceUnitProductRef ref="ENT:AmountOfPriceUnitProduct:SchoolCarnet" version="1"/>
                        </SalesOfferPackageElement>
                    </salesOfferPackageElements>
                </SalesOfferPackage>
            </salesOfferPackages>
            
        </FareFrame>



        <SalesTransactionFrame id="ENT:SalesTransactionFrame:Case1" version="1">

            <customerAccounts>
                <CustomerAccount id="ENT:CustomerAccount:1" version="1"> </CustomerAccount>
            </customerAccounts>

            <fareContracts>
                <FareContract id="ENT:FareContract:1" version="1">

                    <Name>Skolekort Bergen</Name>
                    <StartDate>2020-09-06T01:07:00</StartDate>
                    <EndDate>2021-09-07T01:07:00</EndDate>
                    <fareContractEntries>
                        <!-- Dummy, only way in official netex to get a cpp in is via SalesTransaction -->
                        <SalesTransaction version="1" id="ENT:SalesTransaction:1">
                            <Name>Kj√∏p Skoleskyss</Name>
                            <Date>2018-09-06T01:07:00</Date>
                            <Amount>10000</Amount>
                            <Currency>NOK</Currency>
                            <PaymentMethod>debitCard</PaymentMethod>
                            <customerPurchasePackages>
                                <!-- Referanse til customer purchase packages -->
                                <CustomerPurchasePackageRef ref="ENT:CustomerPurchasePackage:SchoolTransport" version="1"/>
                            </customerPurchasePackages>
                        </SalesTransaction>
                    </fareContractEntries>

                </FareContract>
            </fareContracts>


            <customerPurchasePackages>
                <CustomerPurchasePackage id="ENT:CustomerPurchasePackage:SchoolTransport" version="1">
                    <!-- Governs validity of the whole CPP -->
                    <validityConditions>
                        <AvailabilityConditionRef ref="SKY:AvailabilityCondition:SchoolCalendarBergen2020-2021"/>
                    </validityConditions>
                    <SalesOfferPackageRef ref="ENT:SalesOfferPackage:SchoolTransport" />
                    <customerPurchasePackageElements>
                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:SchoolTransport" version="1" order="1">
                            
                            
                            <SalesOfferPackageElementRef ref="ENT:SalesOfferPackageElement:SchoolTransport" />
                            <elementAccesses>
                                <CustomerPurchasePackageElementAccess id="ENT:CustomerPurchasePackageElementAccess:FirstUsage">
                                    <validityParameterAssignments>
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:S1" version="1" order="1">
                                            
                                        </CustomerPurchaseParameterAssignment>
                                    </validityParameterAssignments>
                                </CustomerPurchasePackageElementAccess>
                            </elementAccesses>
                            
                            <validityParameterAssignments>
                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:1" order="1">
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleTrip" version="1"/>
                                    <AmountOfPriceUnitProductRef ref="ENT:AmountOfPriceUnitProduct:SchoolCarnet" version="1"/>
                                    <limitations>
                                        <!-- Problem: Is it number of Use within an activation period? Or number of activations
                                        
                                        Netex part 3: FREQUENCY OF USE describes the limitation of an access right, 
                                        depending on frequency of use during a VALIDITY PERIOD. 
                                        For instance, a product is offered at a special fare if it 
                                        is used more than 50 times in a month;
                                        
                                        The FREQUENCY OF USE parameter specifies how frequently trips may be made.
                                        
                                        The limits of usage frequency for a FARE PRODUCT (or one of its components) or a SALES OFFER
PACKAGE during a specific VALIDITY PERIOD. There may be different tariffs depending on how often the
right is consumed during the period.

3.53
frequency of use
(Travel Usage Parameters MODEL)
limits of usage frequency for a FARE PRODUCT (or one of its components) or a SALES OFFER PACKAGE during a specific VALIDITY PERIOD
Note 1 to entry: There may be different tariffs depending on how often the right is consumed during the period


TransModel: 
5.15.1.142 FREQUENCY OF USE 4712
(Part 5 - Fare Management (FM)::AR Access Rights Description MODEL::AR Access Right Parameters MODEL 4713 ::AR Travel Usage Parameters MODEL::FREQUENCY OF USE) 4714
The limits of usage frequency for a FARE PRODUCT (or one of its components) or a SALES OFFER 4715 PACKAGE during a specific VALIDITY PERIOD.
                                        -->
                                        <!-- Can only activate 2 a day -->
                                        <FrequencyOfUse id="ENT:FrequencyOfUse:TwiceADay" version="1" >
                                            <FrequencyOfUseType>twiceADay</FrequencyOfUseType>
                                            <MaximalFrequency>2</MaximalFrequency>
                                            <FrequencyInterval>P1D</FrequencyInterval>
                                        </FrequencyOfUse>
                                        <UserProfileRef ref="ENT:UserProfile:Pupil" version="1"/>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:90Min" version="1">
                                            <UsageTrigger>startOutboundRide</UsageTrigger>
                                            <UsageEnd>standardDuration</UsageEnd>
                                            <StandardDuration>PT90M</StandardDuration>
                                            <ActivationMeans>useOfMobileDevice</ActivationMeans> <!-- TODO must be list and include useOfValidator -->
                                        </UsageValidityPeriod>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                        <TariffZoneRef ref="ENT:TariffZone:SkolekretsX"/>
                                    </validityParameters>
                                    <!-- Limits total activations -->
                                    <QualityStructureFactorRef ref="SKY:QualityStructureFactor:190"/>
                                </CustomerPurchaseParameterAssignment>
                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>

                    </customerPurchasePackageElements>
                </CustomerPurchasePackage>
            </customerPurchasePackages>


        </SalesTransactionFrame>

     
    </dataObjects>
</PublicationDelivery>
