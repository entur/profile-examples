<?xml version="1.0" encoding="UTF-8"?>
<PublicationDelivery version="1.08:NO-NeTEx-fares:1.0" xmlns="http://www.netex.org.uk/netex">
    <PublicationTimestamp>2018-09-04T12:00:00</PublicationTimestamp>
    <ParticipantRef>ENT</ParticipantRef>
    <dataObjects>

        <!-- Reference data START -->

        <ResourceFrame id="ENT:ResourceFrame:1" version="1">
            <typesOfValue>
                <!-- Assignment types (categorisation/flags) -->

                <!-- xxPolicyAssignment = assignment rule describing the policy of an AccessRightAssignment, i.e. how to activate/consume the AccessRight -->
                <!-- xxAssignment = assignment rule describing the detailed parameters (limitations / validityParameters) and utilization thereof, applicable for the CPPElement upon activation/consumption -->

                <!-- Transition from MarkedAs=unused to MarkedAs=activated -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationPolicyAssignment" version="1">
                    <Name>ActivationPolicyAssignment</Name>
                    <Description>Rule describing how and when to *activate* a validable element, generates CPPElementAccess with MarkedAs=activated (must be used with a corresponding ENT:TypeOfAccessRightAssignment:UsagePolicyAssignment)</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationAssignment" version="1">
                    <Name>ActivationAssignment</Name>
                    <Description>Rule describing limitations and parameters applicable when the validable element is activated (but not consumed)</Description>
                </TypeOfAccessRightAssignment>

                <!-- Transition from MarkedAs=activated to MarkedAs=used -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:UsagePolicyAssignment" version="1">
                    <Name>UsagePolicyAssignment</Name>
                    <Description>Rule describing how to *consume* a validable element, generates CPPElementAccess with MarkedAs=used (the prerequisite is that the validable element is already MarkedAs=activated)</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:UsageAssignment" version="1">
                    <Name>UsageAssignment</Name>
                    <Description>Rule describing limitations and parameters applicable when the ValidableElement is used, i.e. the acquired travel rights</Description>
                </TypeOfAccessRightAssignment>

                <!-- Transition directly from MarkedAs=unused to MarkedAs=used -->
                <!-- This can be seen as a rule combining Activation(Policy)Assignment and Usage(Policy)Assignment when separate activation and usage is not required -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment" version="1">
                    <Name>ActivationAndUsagePolicyAssignment</Name>
                    <Description>Rule describing how to both *activate* and *consume* in the same operation, generates CPPElementAccess with MarkedAs=used directly (omits MarkedAs=activated)</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment" version="1">
                    <Name>ActivationAndUsageAssignment</Name>
                    <Description>Rule describing limitations and parameters applicable when the ValidableElement is both activated and used in the same operation, i.e. the aquired travel rights</Description>
                </TypeOfAccessRightAssignment>

                <!-- Requirements for retransition from MarkedAs=used to MarkedAs=marked -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:RevalidationPolicyAssignment" version="1">
                    <Name>RevalidationPolicyAssignment</Name>
                    <Description>Rule describing how and when to re-validate a validable element, generates CPPElementAccess with MarkedAs=marked</Description>
                </TypeOfAccessRightAssignment>

                <!-- Subrules to the various xxxPolicyAssignments -->

                <!-- Various specification requirements policies - depending on the type of element that must be provided -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationServiceJourneyPolicyAssignment" version="1">
                    <Name>SpecificationServiceJourneyPolicyAssignment</Name>
                    <Description>Rule describing that a ServiceJourney must be specificed during *activation* or *consumption* or *revalidation*</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationSeatPolicyAssignment" version="1">
                    <Name>SpecificationSeatPolicyAssignment</Name>
                    <Description>Rule describing that a PassengerSeat must be specificed during *activation* or *consumption* or *revalidation*</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationTariffZonePolicyAssignment" version="1">
                    <Name>SpecificationTariffZonePolicyAssignment</Name>
                    <Description>Rule describing that a TariffZone must be specificed during *activation* or *consumption* or *revalidation*</Description>
                </TypeOfAccessRightAssignment>

                <!-- Result of specification requirements -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationAssignment" version="1">
                    <Name>SpecificationAssignment</Name>
                    <Description>Rule describing specified access rights as a result of *activation* or *consumption* or *revalidation*, e.g. specified (selected) service journey or seat</Description>
                </TypeOfAccessRightAssignment>

                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:PreconditionPolicyAssignment" version="1">
                    <Name>PreconditionPolicyAssignment</Name>
                    <Description>Rule describing when a usage validity period may be activated or consumed, used as a subrule for ActivationPolicyAssignment, ActivationAndUsagePolicyAssignment or UsagePolicyAssignment</Description>
                </TypeOfAccessRightAssignment>

                <!-- Logging of activation/consumption/re-validation, i.e. validityParameters recorded on CPPElementAccess -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:AccessLogDetails" version="1">
                    <Name>AccessLogDetails</Name>
                    <Description>CPPAccess with information about an activation / consumption / re-validation</Description>
                </TypeOfAccessRightAssignment>
            </typesOfValue>


            <!-- Organisations (placeholders) -->
            <organisations>
                <Authority id="ENT:Authority:ENT" version="1">
                    <Name>Entur Transport Service Inc</Name>
                </Authority>
            </organisations>
        </ResourceFrame>



        <SiteFrame id="ENT:SiteFrame:1" version="1">
            <tariffZones>
                <TariffZone id="ENT:TariffZone:1" version="1">
                    <Name lang="no">sample Tariff Zone 1</Name>
                    <ParentZoneRef ref="ENT:TariffZone:ALL"/>
                </TariffZone>
                <TariffZone id="ENT:TariffZone:2" version="1">
                    <Name lang="no">sample Tariff Zone 2</Name>
                    <ParentZoneRef ref="ENT:TariffZone:ALL"/>
                </TariffZone>
                <TariffZone id="ENT:TariffZone:ALL" version="1">
                    <Name lang="no">sample all Tariff Zones</Name>
                    <members>
                        <PointRef ref="ENT:TariffZone:1"/>
                        <PointRef ref="ENT:TariffZone:2"/>
                    </members>
                </TariffZone>
            </tariffZones>
        </SiteFrame>



        <FareFrame id="ENT:FareFrame:1" version="1">

            <validableElements>
                <ValidableElement id="ENT:ValidableElement:SingleRide" version="1">
                    <Name>Single ride</Name>
                </ValidableElement>
                <ValidableElement id="ENT:ValidableElement:FatboySeating" version="1">
                    
                    <Name>Fatboy seating</Name>
                </ValidableElement>
            </validableElements>


            <usageParameters>
                <UserProfile id="ENT:UserProfile:Adult" version="1">
                    <Name lang="no">Adult</Name>
                </UserProfile>
                <Interchanging id="ENT:Interchanging:None" version="1">
                    <CanInterchange>false</CanInterchange>
                </Interchanging>
            </usageParameters>


            <fareProducts>
                <PreassignedFareProduct id="ENT:PreassignedFareProduct:SingleTrip" version="1">
                    <Name lang="eng">Standard connected rail trip</Name>
                    <accessRightsInProduct>
                        <AccessRightInProduct id="ENT:AccessRightInProduct:Legs" version="1" order="1">
                            <!-- 2 legs means 2 CPPE, one for each -->
                            <MaximumAccess>2</MaximumAccess>
                            <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>
                        </AccessRightInProduct>
                    </accessRightsInProduct>
                </PreassignedFareProduct>
                <SupplementProduct id="ENT:SupplementProduct:FatboyBeanBag" version="1">
                    <Name lang="eng">Fatboy bean bag seating (numbered)</Name>
                    <accessRightsInProduct>
                        <AccessRightInProduct id="ENT:AccessRightInProduct:SeatingSupplementRight" version="1" order="1">
                            <MaximumAccess>1</MaximumAccess>
                            <ValidableElementRef ref="ENT:ValidableElement:FatboySeating" version="1"/>
                        </AccessRightInProduct>
                    </accessRightsInProduct>
                </SupplementProduct>
            </fareProducts>


            <salesOfferPackages>
                <SalesOfferPackage id="ENT:SalesOfferPackage:SingleTrip" version="1">
                    <Name lang="no">Standard connected rail trip with seat</Name>
                    <salesOfferPackageElements>
                        <SalesOfferPackageElement id="ENT:SalesOfferPackageElement:SingleTrip" version="1" order="1">
                            <Name lang="no">Single trip</Name>
                            <PreassignedFareProductRef ref="ENT:PreassignedFareProduct:SingleTrip" version="1"/>
                        </SalesOfferPackageElement>
                        <SalesOfferPackageElement id="ENT:SalesOfferPackageElement:FatboySeating" version="1" order="1">
                            <Name lang="no">Fatboy bean bag seating (numbered)</Name>
                            <SupplementProductRef ref="ENT:SupplementProduct:FatboyBeanBag" version="1"/>
                        </SalesOfferPackageElement>
                    </salesOfferPackageElements>
                </SalesOfferPackage>
            </salesOfferPackages>

        </FareFrame>

        <!-- Referencedata END -->



        <SalesTransactionFrame id="ENT:SalesTransactionFrame:Case1" version="1">

            <customerAccounts>
                <CustomerAccount id="ENT:CustomerAccount:1" version="1"> </CustomerAccount>
            </customerAccounts>

            <fareContracts>
                <FareContract id="ENT:FareContract:1" version="1">
                    <Name>Rakkestad - Bergen</Name>
                    <StartDate>2020-09-06T01:07:00</StartDate>
                    <EndDate>2021-09-07T01:07:00</EndDate>
                    <fareContractEntries>
                        <SalesTransaction version="1" id="ENT:SalesTransaction:1">
                            <Name>Rakkestad - Bergen</Name>
                            <Date>2018-09-06T01:07:00</Date>
                            <Amount>999</Amount>
                            <Currency>NOK</Currency>
                            <PaymentMethod>debitCard</PaymentMethod>
                            <customerPurchasePackages>
                                <!-- Referanse til customer purchase packages -->
                                <CustomerPurchasePackageRef ref="ENT:CustomerPurchasePackage:PeriodPassNotActivated" version="1"/>
                            </customerPurchasePackages>
                        </SalesTransaction>
                    </fareContractEntries>

                </FareContract>
            </fareContracts>


            <customerPurchasePackages>


                <!-- Example: OPEN 2 leg trip on authrotiy ENT using adult user profile, leg 1 with seating supplement product and leg 2 without.  -->

                <CustomerPurchasePackage id="ENT:CustomerPurchasePackage:PeriodPassNotActivated" version="1">

                    <SalesOfferPackageRef ref="ENT:SalesOfferPackage:SingleTrip"/>
                    
                    <travelSpecifications>
                        <TravelSpecification id="ENT:TravelSpecification:Leg1" version="1">
                            <Name>Open Leg 1 X to Y</Name>
                            <!-- overall usage validity -->
                            <StartOfValidity>2020-01-01T00:00:00</StartOfValidity>
                            <EndOfValidity>2021-01-01T00:00:00</EndOfValidity>
                        </TravelSpecification>
                        <TravelSpecification id="ENT:TravelSpecification:Leg2" version="1">
                            <Name>Open Leg 2 X to Y</Name>
                            <!-- overall usage validity -->
                            <StartOfValidity>2020-01-01T00:00:00</StartOfValidity>
                            <EndOfValidity>2021-01-01T00:00:00</EndOfValidity>
                        </TravelSpecification>
                        <TravelSpecification id="ENT:TravelSpecification:Seat" version="1">
                            <Name>Fatboy seating Open Leg 2 X to Y</Name>
                            <!-- overall usage validity -->
                            <StartOfValidity>2020-01-01T00:00:00</StartOfValidity>
                            <EndOfValidity>2021-01-01T00:00:00</EndOfValidity>
                        </TravelSpecification>
                    </travelSpecifications>


                    <!-- Usage is ordered/dependent -->
                    <consumptionUtilisationDependencies>

                        <!-- Leg 2 and seat supplement product -->
                        <ConsumptionUtilisationDependency id="ENT:ConsumptionUtilisationDependency:2" version="1" order="2">
                            <ConsumptionDependencyGroupingType>AND</ConsumptionDependencyGroupingType>
                            <!-- Elements that must be in given state in order for consumptionUtilisations to transition -->
                            <consumptionDependencies>
                                <CustomerPurchasePackageElementConsumptionDependency id="ENT:CustomerPurchasePackageElementConsumptionDependency:1" version="1">
                                    <MarkedAs>used</MarkedAs>
                                    <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:Leg1" version="1"/>
                                </CustomerPurchasePackageElementConsumptionDependency>
                            </consumptionDependencies>

                            <!-- *May* be executed manually later when dependency conditions are satisfied -->
                            <ConsumptionTransitionPolicy>manual</ConsumptionTransitionPolicy>

                            <!-- Elements in question, see listed ConsumptionUtilisationDependeny above -->
                            <consumptionUtilisations>
                                <CustomerPurchasePackageElementConsumptionUtilisation id="ENT:CustomerPurchasePackageElementConsumptionUtilisation:1" version="1">
                                    <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:Leg2" version="1"/>
                                </CustomerPurchasePackageElementConsumptionUtilisation>
                                <CustomerPurchasePackageElementConsumptionUtilisation  id="ENT:CustomerPurchasePackageElementConsumptionUtilisation:2" version="1">
                                    <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:Seat" version="1"/>
                                </CustomerPurchasePackageElementConsumptionUtilisation>
                            </consumptionUtilisations>

                            <!-- Requires that these to specification assignments must get values according to given constraint 
                                I.e. that the servicejourney for leg2 is identical to the servicejourney for the supplement seat -->
                            <crossConstraints>
                                <CrossConstraint id="ENT:CrossConstraint:1" version="1">
                                    <Constraint>
                                        <JourneyConstraint>same</JourneyConstraint>
                                    </Constraint>
                                    <validityParameterAssignments>
                                        <CustomerPurchaseParameterAssignmentRef ref="ENT:CustomerPurchaseParameterAssignment:ServiceJourneyLeg2SelectionRequirement" version="1"/>
                                        <CustomerPurchaseParameterAssignmentRef ref="ENT:CustomerPurchaseParameterAssignment:ServiceJourneyLeg2SeatSelectionRequirement" version="1"/>
                                    </validityParameterAssignments>
                                </CrossConstraint>
                            </crossConstraints>

                            <!-- Number of times MarkedAs=used can appear in total for given elements-->
                            <MaximumNumberOfAccesses>
                                <Type>limited</Type>
                                <Value>1</Value>
                            </MaximumNumberOfAccesses>
                        </ConsumptionUtilisationDependency>
                    </consumptionUtilisationDependencies>



                    <customerPurchasePackageElements>

                        <!-- LEG 1 -->
                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:Leg1" version="1" order="1">
                            <elementAccesses>

                                <!-- *Activation* leg1 entry -->
                                <CustomerPurchasePackageElementAccess>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>
                                    <MarkedAs>activated</MarkedAs>
                                    <!-- PROPOSED AS ADDITION TO THE STANDARD: Validity period as a result of the activation (ServiceJourney date) -->
                                    <StartOfValidity>2020-01-01T00:00:00</StartOfValidity>
                                    <EndOfValidity>2020-01-02T00:00:00</EndOfValidity>
                                    <validityParameterAssignments>
                                        <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:ActivationLeg1" order="1">
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpecificationAssignment" version="1"/>
                                            <validityParameters>
                                                <ServiceJourneyRef ref="ENT:ServiceJourney:Leg1"/>
                                            </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                    </validityParameterAssignments>
                                </CustomerPurchasePackageElementAccess>

                                <CustomerPurchasePackageElementAccess>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>
                                    <MarkedAs>used</MarkedAs>
                                    <!-- PROPOSED AS ADDITION TO THE STANDARD: Validity period as a result of the activation (ServiceJourney date) -->
                                    <StartOfValidity>2020-01-01T00:00:00</StartOfValidity>
                                    <EndOfValidity>2020-01-02T00:00:00</EndOfValidity>
                                </CustomerPurchasePackageElementAccess>

                            </elementAccesses>


                            <!-- The GroupOfValidityParameterAssignment groups different parameter assignments. 
                                In this example, this is used to bind together a xxxPolicyAssignemnt with the corresponding xxxAssignment as there may be more than one set of parameters.
                                The Norwegian/Nordic NeTEx profile will describe which corresponding types of CPPAs (TypeOfAccessRightAssignment) that are allowed to be be grouped.
                                
                                An example use of multiple GroupOfValidityParameterAssignments is to allow different parameters to be applied depending on activation rules, ie
                                activation on weekdays gives 2 hours of travel while in the weekends 3 hours.
                            --> 

                            <groupsOfCustomerPurchaseParameterAssignments>
                                <GroupOfCustomerPurchaseParameterAssignments id="ENT:IdenticalCustomerPurchaseParameterAssignment:1" version="1">
                                    <!-- Multiple CPPA refs -->
                                    <CustomerPurchaseParameterAssignmentRef ref="ENT:CustomerPurchaseParameterAssignment:Leg1-Activation1" version="1"/>
                                    <CustomerPurchaseParameterAssignmentRef ref="ENT:CustomerPurchaseParameterAssignment:Leg1-Validity" version="1"/>
                                </GroupOfCustomerPurchaseParameterAssignments>
 
                                <!-- Multiple GroupOfValidityParameterAssignments -->
                            </groupsOfCustomerPurchaseParameterAssignments>

                            <validityParameterAssignments>
                                <!-- LEG 1 -->
                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Leg1-Activation" order="1">
                                    <!-- This type defines uvp activation rules -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide"/>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:1year" version="1">
                                            <UsageTrigger>activation</UsageTrigger>
                                            <!-- must generate an elementAccess/activated before use -->
                                            <UsageEnd>endOfRide</UsageEnd>
                                            <ActivationMeans>useOfMobileDevice useOfValidator</ActivationMeans>
                                            <StartDate>2020-01-01</StartDate>
                                            <EndDate>2020-01-01</EndDate>
                                        </UsageValidityPeriod>
                                    </limitations>

                                    <!-- Only once -->
                                    <MaximumNumberOfAccesses>
                                        <Type>limited</Type>
                                        <Value>1</Value>
                                    </MaximumNumberOfAccesses>
                                    
                                    
                                    <includes>
                                        <!-- Parameters that must be selected
                                        
                                        Any valdityParameters and limitations listed here are in ADDITION to the ones specified in the Assignment
                                        
                                        -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:ServiceJourneyLeg2SeatSelectionRequirementLeg1" version="1" order="1">
                                            <!-- Selected service journey -->
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpeficationRequirementServiceJourney"/>
                                            <ValidityParameterGroupingType>OR</ValidityParameterGroupingType>
                                            <validityParameters>
                                                <LineRef ref="ENT:Line:1"/>
                                                <LineRef ref="ENT:Line:2"/>
                                                </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                    </includes>

                                </CustomerPurchaseParameterAssignment>



                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Leg1-Validity" order="1">
                                    <!-- This type defines the validable element parameters when access right is activated -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide"/>
                                    <DistanceMatrixElement id="ENT:DistanceMatrixElement:Leg1" version="21">
                                        <StartStopPointRef ref="NSR:ScheduledStopPoint:S123"/>
                                        <EndStopPointRef ref="NSR:ScheduledStopPoint:S555"/>
                                    </DistanceMatrixElement>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <InterchangingRef ref="ENT:Interchanging:None"/>
                                        <UserProfileRef ref="ENT:UserProfile:Adult" version="1"/>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                    </validityParameters>
                                </CustomerPurchaseParameterAssignment>

                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>

                        <!-- LEG 2 -->
                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:Leg2" version="1" order="1">

                            <elementAccesses>
                                <!-- *Activation* Leg2 entry -->
                                <CustomerPurchasePackageElementAccess>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>
                                    <MarkedAs>activated</MarkedAs>
                                    <!-- PROPOSED AS ADDITION TO THE STANDARD: Validity period as a result of the activation (ServiceJourney in this case) -->
                                    <StartOfValidity>2020-01-01T12:05:00</StartOfValidity>
                                    <EndOfValidity>2020-01-01T18:35:00</EndOfValidity>
                                    <validityParameterAssignments>
                                        <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:ActivationLeg2" order="1">
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpecificationAssignment" version="1"/>
                                            <validityParameters>
                                                <ServiceJourneyRef ref="ENT:ServiceJourney:Leg2"/>
                                            </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                    </validityParameterAssignments>
                                </CustomerPurchasePackageElementAccess>

                                <CustomerPurchasePackageElementAccess>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>
                                    <MarkedAs>used</MarkedAs>
                                    <!-- PROPOSED AS ADDITION TO THE STANDARD: Validity period as a result of the activation (UVP/StandardDuration in this case) -->
                                    <StartOfValidity>2020-01-01T12:05:00</StartOfValidity>
                                    <EndOfValidity>2020-01-01T18:35:00</EndOfValidity>
                                </CustomerPurchasePackageElementAccess>
                            </elementAccesses>

                            <validityParameterAssignments>

                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Leg2-Activation" order="1">

                                    <!-- This type defines uvp activation rules -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:X30kDays" version="1">
                                            <UsageTrigger>activation</UsageTrigger>
                                            <UsageEnd>endOfRide</UsageEnd>
                                            <ActivationMeans>useOfMobileDevice useOfValidator</ActivationMeans>
                                            <StartDate>2020-01-01</StartDate>
                                            <EndDate>2020-01-01</EndDate>
                                        </UsageValidityPeriod>
                                    </limitations>

                                    <!-- Only once -->
                                    <MaximumNumberOfAccesses>
                                        <Type>limited</Type>
                                        <Value>1</Value>
                                    </MaximumNumberOfAccesses>
                                    
                                    <includes>
                                        <!-- Parameters that must be selected -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:ServiceJourneyLeg2SelectionRequirement" version="1" order="1">
                                            <!-- Selected service journey -->
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpeficationRequirementServiceJourney"/>
                                            <ValidityParameterGroupingType>OR</ValidityParameterGroupingType>
                                            <validityParameters>
                                                <GroupOfLinesRef ref="ENT:GroupOfLine:Green"/>
                                                <LineRef ref="ENT:Line:3"/>
                                                <LineRef ref="ENT:Line:4"/>
                                            </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                    </includes>

                                </CustomerPurchaseParameterAssignment>




                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Leg2-Validity" order="1">
                                    <!-- This type defines the validable element parameters when access right is activated -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:SingleRide" version="1"/>
                                    <DistanceMatrixElement id="ENT:DistanceMatrixElement:Leg2" version="21">
                                        <StartStopPointRef ref="NSR:ScheduledStopPoint:S19923"/>
                                        <EndStopPointRef ref="NSR:ScheduledStopPoint:S55995"/>
                                    </DistanceMatrixElement>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <InterchangingRef ref="ENT:Interchanging:None"/>
                                        <UserProfileRef ref="ENT:UserProfile:Adult" version="1"/>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                    </validityParameters>
                                </CustomerPurchaseParameterAssignment>
                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>

                        <!-- Seat supplement element leg 2 -->

                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:Seat" version="1" order="1">

                            <elementAccesses>

                                <!--
                                unused - not ready for consumption (implicit if not given)
                                activated - ready for consumption
                                used - consumed
                                marked - validated/read by validator or ticket inspector
                                
                                eks: monthly pass: requires activation, and "used"+start/end. validation entries "marked". uvpTrigger=activation, start/end based on standardduration or timeintervalref
                                single ticket, preactivated - no activation necessary, "used"+start/end added immediately after purchase uvpTrigger=noneRequired, start/end given explicitly
                                carnet: each time a user activates one, a used+start/end entry is added uvpTrigger=activation, start/end depends on standardduration or timeintervalref
                                school transport: activation first time + "used", then "used"+start/end entries uvpTrigger=activation, start/end depends on standardduration or timeintervalref
                                open ticket: activated + "used"+start/end upon selection = uvpTrigger=activation, start/end depends on standardduration or timeintervalref
                                supplement coffee: typically activated as part of leg, "used" for each cup of coffee (no start/end time) uvpTrigger=activation, no uvp+standardduration nor timeintervalref set, using serviceJourney bounds for start/end
                            -->

                                <!-- *Activation* entry -->
                                <CustomerPurchasePackageElementAccess>
                                    <MarkedAs>activated</MarkedAs>
                                    <!-- PROPOSED AS ADDITION TO THE STANDARD: Validity period as a result of the activation (UVP/StandardDuration in this case) -->
                                    <StartOfValidity>2020-01-01T12:05:00</StartOfValidity>
                                    <EndOfValidity>2020-01-01T18:35:00</EndOfValidity>
                                    <validityParameterAssignments>
                                        <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Leg2Seat-Activation" order="1">
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpecificationAssignment" version="1"/>
                                            <ValidableElementRef ref="ENT:ValidableElement:FatboySeating" version="1"/>

                                            <validityParameters>
                                                <!-- PassengerSeat not yet defined -->
                                                <!-- Actual seat selected is registered here -->
                                                <PassengerSeatRef ref="ENT:PassengerSeat:Fatboy1"/>

                                                <!--   
                                                    Sketch of what PassengerSeating could be
                                                    
                                                <PassengerSeating id="ENT:PassengerSeating:1" version="1">
                                                    <Name lang="nob">Øvre Sete 5</Name>
                                                    <alternativeNames>
                                                        <AltnerativeName lang="eng">Upper Seat 5</AltnerativeName>
                                                    </alternativeNames>
                                                    <TrainRef ref="NSB:Train:Dovrebussen"/>
                                                    <TrainElementRef ref="PEN:LogicalElement:SETRA-S431DT-LOWER" versionRef="2"/>
                                                    <SeatingEquipmentRef ref="ENT:SeatingEquipmentRef:XYX"/>
                                                </PassengerSeating>
                                                 -->

                                                <ServiceJourneyRef ref="ENT:ServiceJourney:Leg2"/>
                                            </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                    </validityParameterAssignments>
                                </CustomerPurchasePackageElementAccess>

                                <CustomerPurchasePackageElementAccess created="2020-01-01T00:00:00">
                                    <MarkedAs>used</MarkedAs>
                                    <!-- PROPOSED AS ADDITION TO THE STANDARD: Validity period as a result of the activation (ServiceJourney) -->
                                    <StartOfValidity>2020-01-01T00:00:00</StartOfValidity>
                                    <EndOfValidity>2020-01-01T23:59:59</EndOfValidity>
                                </CustomerPurchasePackageElementAccess>

                            </elementAccesses>

                            <validityParameterAssignments>


                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Multileg2-Seat-Activation" order="1">

                                    <!-- This type defines uvp activation rules -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:FatboySeating" version="1"/>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:1yearr" version="1">
                                            <UsageTrigger>activation</UsageTrigger>
                                            <UsageEnd>endOfRide</UsageEnd>
                                            <ActivationMeans>useOfMobileDevice useOfValidator</ActivationMeans>
                                            <StartDate>2020-01-01</StartDate>
                                            <EndDate>2020-11-01</EndDate>
                                        </UsageValidityPeriod>
                                        <Reserving id="ENT:Reserving:Seating" version="1">
                                            <ReservingRequirements>reservationsCompulsory</ReservingRequirements>
                                        </Reserving>
                                    </limitations>

                                    <!-- Only once -->
                                    <MaximumNumberOfAccesses>
                                        <Type>limited</Type>
                                        <Value>1</Value>
                                    </MaximumNumberOfAccesses>
                                    
                                    <IncludesGroupingType>AND</IncludesGroupingType>
                                    <includes>
                                        <!-- Parameters that must be selected -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:ServiceJourneyLeg2SeatSelectionRequirement" version="1" order="1">
                                            <!-- Selected service journey -->
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpeficationRequirementServiceJourney"/>
                                            <ValidityParameterGroupingType>OR</ValidityParameterGroupingType>
                                            <validityParameters>
                                                
                                                <GroupOfLinesRef ref="ENT:GroupOfLine:Green"/>
                                                <LineRef ref="ENT:Line:3"/>
                                                <LineRef ref="ENT:Line:4"/>
                                                
                                            </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                        <!-- Parameters that must be selected -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:ServiceJourneyLeg2SeatSelectionRequirementSeat" version="1" order="1">
                                            <!-- Selected service journey -->
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpeficationRequirementSeat"/>
                                        </CustomerPurchaseParameterAssignment>
                                    </includes>

                                </CustomerPurchaseParameterAssignment>


                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Multileg2-Seat-Validity" order="1">
                                    <!-- This type defines the validable element parameters when access right is activated -->

                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:FatboySeating" version="1"/>
                                    <DistanceMatrixElement id="ENT:DistanceMatrixElement:Leg2-Seat" version="21">
                                        <StartStopPointRef ref="NSR:ScheduledStopPoint:S19923"/>
                                        <EndStopPointRef ref="NSR:ScheduledStopPoint:S55995"/>
                                    </DistanceMatrixElement>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>

                                        <UserProfileRef ref="ENT:UserProfile:Adult" version="1"/>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <LineRef ref="ENT:Line:1"/>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                    </validityParameters>
                                </CustomerPurchaseParameterAssignment>
                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>
                    </customerPurchasePackageElements>
                </CustomerPurchasePackage>
            </customerPurchasePackages>
        </SalesTransactionFrame>


    </dataObjects>
</PublicationDelivery>
