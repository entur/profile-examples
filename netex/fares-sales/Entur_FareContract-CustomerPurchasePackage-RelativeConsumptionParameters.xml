<?xml version="1.0" encoding="UTF-8"?>
<PublicationDelivery version="1.08:NO-NeTEx-fares:1.0" xmlns="http://www.netex.org.uk/netex">
    <PublicationTimestamp>2018-09-04T12:00:00</PublicationTimestamp>
    <ParticipantRef>ENT</ParticipantRef>
    <dataObjects>

        <!-- Boat ticket carnet
            
            A boat trip also gives right to ride bus in the same zone that the boat departs and arrives 
            3 validable elements, one for bus before boat, one for the boat ride itself and one for the bus ride after
            Ie: Bus zone A, boat from stop X (inside zone A to stop Y inside zone B, bus zone B)
            
            -->
            

        <!-- Reference data START -->

        <ResourceFrame id="ENT:ResourceFrame:1" version="1">
            <typesOfValue>
                <!-- Assignment types (categorisation/flags) -->

                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:CommonAssignment" version="1">
                    <Name>CommonAssignment</Name>
                    <Description>Assignment describing common parameters applicable to all xxxPolicyAssignment and xxxAssignment</Description>
                </TypeOfAccessRightAssignment>
                

                <!-- xxPolicyAssignment = assignment rule describing the policy of an AccessRightAssignment, i.e. how to activate/consume the AccessRight -->
                <!-- xxAssignment = assignment rule describing the detailed parameters (limitations / validityParameters) and utilization thereof, applicable for the CPPElement upon activation/consumption -->

                <!-- Transition from MarkedAs=unused to MarkedAs=activated -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationPolicyAssignment" version="1">
                    <Name>ActivationPolicyAssignment</Name>
                    <Description>Rule describing how and when to *activate* a validable element, generates CPPElementAccess with MarkedAs=activated (must be used with a corresponding ENT:TypeOfAccessRightAssignment:UsagePolicyAssignment)</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationAssignment" version="1">
                    <Name>ActivationAssignment</Name>
                    <Description>Rule describing limitations and parameters applicable when the validable element is activated (but not consumed)</Description>
                </TypeOfAccessRightAssignment>

                <!-- Transition from MarkedAs=activated to MarkedAs=used -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:UsagePolicyAssignment" version="1">
                    <Name>UsagePolicyAssignment</Name>
                    <Description>Rule describing how to *consume* a validable element, generates CPPElementAccess with MarkedAs=used (the prerequisite is that the validable element is already MarkedAs=activated)</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:UsageAssignment" version="1">
                    <Name>UsageAssignment</Name>
                    <Description>Rule describing limitations and parameters applicable when the ValidableElement is used, i.e. the acquired travel rights</Description>
                </TypeOfAccessRightAssignment>

                <!-- Transition directly from MarkedAs=unused to MarkedAs=used -->
                <!-- This can be seen as a rule combining Activation(Policy)Assignment and Usage(Policy)Assignment when separate activation and usage is not required -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment" version="1">
                    <Name>ActivationAndUsagePolicyAssignment</Name>
                    <Description>Rule describing how to both *activate* and *consume* in the same operation, generates CPPElementAccess with MarkedAs=used directly (omits MarkedAs=activated)</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment" version="1">
                    <Name>ActivationAndUsageAssignment</Name>
                    <Description>Rule describing limitations and parameters applicable when the ValidableElement is both activated and used in the same operation, i.e. the aquired travel rights</Description>
                </TypeOfAccessRightAssignment>

                <!-- Requirements for retransition from MarkedAs=used to MarkedAs=marked -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:RevalidationPolicyAssignment" version="1">
                    <Name>RevalidationPolicyAssignment</Name>
                    <Description>Rule describing how and when to re-validate a validable element, generates CPPElementAccess with MarkedAs=marked</Description>
                </TypeOfAccessRightAssignment>

                <!-- Subrules to the various xxxPolicyAssignments -->

                <!-- Various specification requirements policies - depending on the type of element that must be provided -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationServiceJourneyPolicyAssignment" version="1">
                    <Name>SpecificationServiceJourneyPolicyAssignment</Name>
                    <Description>Rule describing that a ServiceJourney must be specificed during *activation* or *consumption* or *revalidation*</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationSeatPolicyAssignment" version="1">
                    <Name>SpecificationSeatPolicyAssignment</Name>
                    <Description>Rule describing that a PassengerSeat must be specificed during *activation* or *consumption* or *revalidation*</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationTariffZonePolicyAssignment" version="1">
                    <Name>SpecificationTariffZonePolicyAssignment</Name>
                    <Description>Rule describing that a TariffZone must be specificed during *activation* or *consumption* or *revalidation*</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationStartTimePolicyAssignment" version="1">
                    <Name>SpecificationStartTimePolicyAssignment</Name>
                    <Description>Rule describing that the desired activation/consumption start time must be within specified rules</Description>
                </TypeOfAccessRightAssignment>
                
                <!-- Result of specification requirements -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:SpecificationAssignment" version="1">
                    <Name>SpecificationAssignment</Name>
                    <Description>Rule describing specified access rights as a result of *activation* or *consumption* or *revalidation*, e.g. specified (selected) service journey or seat</Description>
                </TypeOfAccessRightAssignment>

                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:ExecutionTimePolicyAssignment" version="1">
                    <Name>ExecutionTimePolicyAssignment</Name>
                    <Description>Rule describing *when* something can be executed, ie access right must be activated within 1 week or only once a day. Used as a sub rule to ActivationPolicyAssignment, ActivationAndUsagePolicyAssignment or UsagePolicyAssignment</Description>
                </TypeOfAccessRightAssignment>

                <!-- Logging of activation/consumption/re-validation, i.e. validityParameters recorded on CPPElementAccess -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:AccessLogDetails" version="1">
                    <Name>AccessLogDetails</Name>
                    <Description>CPPAccess with information about an activation / consumption / re-validation</Description>
                </TypeOfAccessRightAssignment>
                
                
                <!-- Postpaid rules defining how to activate a postpaid element for consumption and which open access rights that are provided as part of the contract -->
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:PostpaidUsagePolicyAssignment" version="1">
                    <Name>PostpaidPolicyAssignment</Name>
                    <Description>Rule describing how to *activate* a postpaid element</Description>
                </TypeOfAccessRightAssignment>
                <TypeOfAccessRightAssignment id="ENT:TypeOfAccessRightAssignment:PostpaidUsageAssignment" version="1">
                    <Name>PostpaidUsageAssignment</Name>
                    <Description>Rule describing open access rights given in a postpaid contract (where actual completed journeys are computed and stored in CustomerPurchasePackageElementAccesses)</Description>
                </TypeOfAccessRightAssignment>
                
                
            </typesOfValue>


            <!-- Organisations (placeholders) -->
            <organisations>
                <Authority id="ENT:Authority:ENT" version="1">
                    <Name>Entur Transport Service Inc</Name>
                </Authority>
            </organisations>
        </ResourceFrame>

        <FareFrame id="ENT:FareFrame:1" version="1">

            <validableElements>
                <ValidableElement id="ENT:ValidableElement:BusToBoat" version="1">
                    <Name>Single ride bus to boat</Name>
                </ValidableElement>
                <ValidableElement id="ENT:ValidableElement:Boat" version="1">
                    <Name>Boat ride</Name>
                </ValidableElement>
                <ValidableElement id="ENT:ValidableElement:BusAfterBoat" version="1">
                    <Name>Single ride bus after boat</Name>
                </ValidableElement>
            </validableElements>


            <usageParameters>
                <UserProfile id="ENT:UserProfile:Adult" version="1">
                    <Name lang="no">Adult</Name>
                </UserProfile>
            </usageParameters>


            <fareProducts>
                <AmountOfPriceUnitProduct id="ENT:AmountOfPriceUnitProduct:BoatCarnet" version="1">
                    <Name lang="eng">10 rides on boat with connecting bus before and after boat ride</Name>
                    <accessRightsInProduct>
                        <AccessRightInProduct id="ENT:AccessRightInProduct:BusToBoat" version="1" order="1">
                            <MaximumAccess>1</MaximumAccess>
                            <ValidableElementRef ref="ENT:ValidableElement:BusToBoat" version="1"/>
                        </AccessRightInProduct>
                        <AccessRightInProduct id="ENT:AccessRightInProduct:Boat" version="1" order="1">
                            <MaximumAccess>1</MaximumAccess>
                            <ValidableElementRef ref="ENT:ValidableElement:Boat" version="1"/>
                        </AccessRightInProduct>
                        <AccessRightInProduct id="ENT:AccessRightInProduct:BusAfterBoat" version="1" order="1">
                            <MaximumAccess>1</MaximumAccess>
                            <ValidableElementRef ref="ENT:ValidableElement:BusAfterBoat" version="1"/>
                        </AccessRightInProduct>
                    </accessRightsInProduct>
                </AmountOfPriceUnitProduct>
            </fareProducts>


            <salesOfferPackages>
                <SalesOfferPackage id="ENT:SalesOfferPackage:BoatCarnet" version="1">
                    <Name lang="eng">10 rides on boat with connecting bus before and after boat ride</Name>

                    <consumptionDependencies>
                
                        <!-- Consume bus before and after boat ride with relative intervals -->
                        <ConsumptionDependency id="ENT:ConsumptionDependency:1" version="1" >
                            <ConsumptionRequirementGroupingType>AND</ConsumptionRequirementGroupingType>
                            <!-- Elements that must be in given state in order for consumptions to transition -->
                            <consumptionRequirements>
                                <AccessRightInProductConsumptionRequirement id="ENT:CustomerPurchasePackageElementConsumptionRequirement:BoatConsumed" version="1">
                                    <MarkedAs>used</MarkedAs>
                                    <MarkedAsTemporalValidity>currentFuture</MarkedAsTemporalValidity>
                                    <AccessRightInProductRef ref="ENT:AccessRightInProduct:Boat" version="1"/>
                                </AccessRightInProductConsumptionRequirement>
                            </consumptionRequirements>
                            
                            <!--Will trigger automatic consume of the bus to boat and bus from boat  -->
                            <ConsumptionTransitionPolicy>automatic</ConsumptionTransitionPolicy>
                            
                            <consumptions>
                                
                                
                                <!-- Automatic consumption of bus before boat -->
                                <AccessRightInProductConsumption id="ENT:BusToBoat:BusToBoat" version="1">
                                    <FromMarkedAs>unused</FromMarkedAs>
                                    <ToMarkedAs>used</ToMarkedAs>
                                    <AccessRightInProductRef ref="ENT:CustomerPurchasePackageElement:BusToBoat" version="1"/>
                                    <AccessNumber>1</AccessNumber>
                                    <specificationPolicyAssignmentInputs>
                                        <AccessRightInProductSpecificationStartTimePolicyAssignmentInput>
                                            <!-- Siste elementAccess på denne CPPE -->
                                            <AccessRightInProductRef ref="ENT:AccessRightInProduct:Boat" version="1"/>
                                            <!-- CPPA som spesifiserer kravet om startTime -->
                                            <GenericParameterAssignmentRef ref="ENT:GenericParameterAssignment:BusToBoatStartTime"/>
                                            
                                            <!-- relativt til boat elementAcccess -->
                                            <RelativeTo>startOfValidity</RelativeTo> <!-- endOfValidity -->
                                            
                                            <!-- startTime som sendes til SpecificationStartTimePA = startOfValditiy på boat PLUSS gitt timeInterval (her negativt) -->
                                            <!-- Negativt timeinterval for ting som skal starte før -->
                                            <TimeIntervalRef ref="ENT:TimeInterval:45MinutesBefore"/>
                                        </AccessRightInProductSpecificationStartTimePolicyAssignmentInput>
                                    </specificationPolicyAssignmentInputs>
                                </AccessRightInProductConsumption>
                                
                                <!-- Automatic consumption of bus AFTER boat -->
                                <AccessRightInProductConsumption id="ENT:BusToBoat:BusFromBoat" version="1">
                                    <FromMarkedAs>unused</FromMarkedAs>
                                    <ToMarkedAs>used</ToMarkedAs>
                                    <AccessRightInProductRef ref="ENT:CustomerPurchasePackageElement:BusFromBoat" version="1"/>
                                    <AccessNumber>1</AccessNumber>
                                    <specificationPolicyAssignmentInputs>
                                        <AccessRightInProductSpecificationStartTimePolicyAssignmentInput>
                                            <!-- Siste elementAccess på denne CPPE -->
                                            <AccessRightInProductRef ref="ENT:AccessRightInProduct:Boat" version="1"/>
                                            <!-- CPPA som spesifiserer kravet om startTime -->
                                            <GenericParameterAssignmentRef ref="ENT:GenericParameterAssignment:BusFromBoatStartTime"/>
                                            
                                            <!-- relativt til boat elementAcccess -->
                                            <RelativeTo>startOfValidity</RelativeTo> <!-- endOfValidity -->
                                            
                                            <!-- startTime som sendes til SpecificationStartTimePA = startOfValditiy på boat PLUSS gitt timeInterval (her negativt) -->
                                            <!-- Negativt timeinterval for ting som skal starte før -->
                                            <TimeIntervalRef ref="ENT:TimeInterval:45MinutesBefore"/>
                                        </AccessRightInProductSpecificationStartTimePolicyAssignmentInput>
                                    </specificationPolicyAssignmentInputs>
                                </AccessRightInProductConsumption>
                                
                            </consumptions>
                        </ConsumptionDependency>
                        
                    </consumptionDependencies>

                    <salesOfferPackageElements>
                        <SalesOfferPackageElement id="ENT:SalesOfferPackageElement:BoatCarnet" version="1" order="1">
                            <Name lang="no">Carnet of boat trips</Name>
                            <AmountOfPriceUnitProductRef ref="ENT:AmountOfPriceUnitProduct:BoatCarnet" version="1"/>
                        </SalesOfferPackageElement>
                    </salesOfferPackageElements>
                </SalesOfferPackage>
            </salesOfferPackages>

        </FareFrame>

        <!-- Referencedata END -->



        <SalesTransactionFrame id="ENT:SalesTransactionFrame:Case1" version="1">

            <customerAccounts>
                <CustomerAccount id="ENT:CustomerAccount:1" version="1"> </CustomerAccount>
            </customerAccounts>

            <fareContracts>
                <FareContract id="ENT:FareContract:1" version="1">
                    <Name>Boat canet</Name>
                    <StartDate>2020-09-06T01:07:00</StartDate>
                    <EndDate>2021-09-07T01:07:00</EndDate>
                    <fareContractEntries>
                        <SalesTransaction version="1" id="ENT:SalesTransaction:1">
                            <Name>Bus carnet</Name>
                            <Date>2018-09-06T01:07:00</Date>
                            <Amount>999</Amount>
                            <Currency>NOK</Currency>
                            <PaymentMethod>debitCard</PaymentMethod>
                            <customerPurchasePackages>
                                <!-- Referanse til customer purchase packages -->
                                <CustomerPurchasePackageRef ref="ENT:CustomerPurchasePackage:BoatCarnet" version="1"/>
                            </customerPurchasePackages>
                        </SalesTransaction>
                    </fareContractEntries>

                </FareContract>
            </fareContracts>


            <customerPurchasePackages>


                <CustomerPurchasePackage id="ENT:CustomerPurchasePackage:BoatCarnet" version="1">

                    <SalesOfferPackageRef ref="ENT:SalesOfferPackage:BoatCarnet"/>
                    
                    <!-- TODO travelspecifications -->
                    <travelSpecifications>
                        
                    </travelSpecifications>


                    <consumptionDependencies>

                        <!-- Consume bus before and after boat ride with relative intervals -->
                        <ConsumptionDependency id="ENT:ConsumptionDependency:1" version="1" >
                            <ConsumptionRequirementGroupingType>AND</ConsumptionRequirementGroupingType>
                            <!-- Elements that must be in given state in order for consumptions to transition -->
                            <consumptionRequirements>
                                <CustomerPurchasePackageElementConsumptionRequirement id="ENT:CustomerPurchasePackageElementConsumptionRequirement:BoatConsumed" version="1">
                                    <MarkedAs>used</MarkedAs>
                                    <MarkedAsTemporalValidity>currentFuture</MarkedAsTemporalValidity>
                                    <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:Boat" version="1"/>
                                </CustomerPurchasePackageElementConsumptionRequirement>
                            </consumptionRequirements>

                            <!--Will trigger automatic consume of the bus to boat and bus from boat  -->
                            <ConsumptionTransitionPolicy>automatic</ConsumptionTransitionPolicy>

                            <consumptions>
                                
                                
                                <!-- Automatic consumption of bus before boat -->
                                <CustomerPurchasePackageElementConsumption id="ENT:CustomerPurchasePackageElementConsumption:BusToBoat" version="1">
                                    <FromMarkedAs>unused</FromMarkedAs>
                                    <ToMarkedAs>used</ToMarkedAs>
                                    <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:BusToBoat" version="1"/>
                                 
                                    <specificationPolicyAssignmentInputs>
                                        <CustomerPurchasePackageSpecificationStartTimePolicyAssignmentInput>
                                            <!-- Siste elementAccess på denne CPPE -->
                                            <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:Boat" version="1"/>
                                            <!-- CPPA som spesifiserer kravet om startTime -->
                                            <CustomerPurchaseParameterAssignmentRef ref="ENT:CustomerPurchaseParameterAssignment:BusToBoatStartTime"/>
                                            
                                            <!-- relativt til boat elementAcccess -->
                                            <RelativeTo>startOfValidity</RelativeTo> <!-- endOfValidity -->
                                            
                                            <!-- startTime som sendes til SpecificationStartTimePA = startOfValditiy på boat PLUSS gitt timeInterval (her negativt) -->
                                            <!-- Negativt timeinterval for ting som skal starte før -->
                                            <TimeIntervalRef ref="ENT:TimeInterval:45MinutesBefore"/>
                                        </CustomerPurchasePackageSpecificationStartTimePolicyAssignmentInput>
                                    </specificationPolicyAssignmentInputs>
                                </CustomerPurchasePackageElementConsumption>

                                <!-- Automatic consumption of bus AFTER boat -->
                                <CustomerPurchasePackageElementConsumption id="ENT:CustomerPurchasePackageElementConsumption:BusFromBoat" version="1">
                                    <FromMarkedAs>unused</FromMarkedAs>
                                    <ToMarkedAs>used</ToMarkedAs>
                                    <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:BusFromBoat" version="1"/>
                                    
                                    <specificationPolicyAssignmentInputs>
                                        <CustomerPurchasePackageSpecificationStartTimePolicyAssignmentInput>
                                            <!-- Siste elementAccess på denne CPPE -->
                                            <CustomerPurchasePackageElementRef ref="ENT:CustomerPurchasePackageElement:Boat" version="1"/>
                                            <!-- CPPA som spesifiserer kravet om startTime -->
                                            <CustomerPurchaseParameterAssignmentRef ref="ENT:CustomerPurchaseParameterAssignment:BusFromBoatStartTime"/>
                                            
                                            <!-- relativt til et elementAcccess -->
                                            <RelativeTo>endOfValidity</RelativeTo> 
                                            
                                            <!-- endOfValidity på elementAccess for boat + angitt tid -->
                                            <TimeIntervalRef ref="ENT:TimeInterval:45Minutes"/>
                                        </CustomerPurchasePackageSpecificationStartTimePolicyAssignmentInput>
                                    </specificationPolicyAssignmentInputs>
                                </CustomerPurchasePackageElementConsumption>
                                
                            </consumptions>
                        </ConsumptionDependency>
                    </consumptionDependencies>



                    <customerPurchasePackageElements>

                        <!-- Bus to boat -->
                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:BusToBoat" version="1" order="1">
                            
                            <!-- TODO example element access -->
                            <elementAccesses>

                                 </elementAccesses>

                            <validityParameterAssignments>
                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:BusToBoat" order="1">
                                    <!-- This type defines uvp activation rules -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:BusToBoat" version="1"/>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:BusToBoat" version="1">
                                            <UsageTrigger>specifiedStartDate</UsageTrigger>
                                            <UsageEnd>standardDuration</UsageEnd>
                                            <ActivationMeans>automaticByDependency</ActivationMeans>
                                        </UsageValidityPeriod>
                                    </limitations>
                                    
                                    <TimeIntervalRef ref="ENT:TimeInterval:45Minutes"/>
                                    
                                    <!-- 10 times -->
                                    <MaximumNumberOfAccesses>
                                        <Type>limited</Type>
                                        <Value>10</Value>
                                    </MaximumNumberOfAccesses>
                                    
                                    
                                    <includes>
                                        <!-- Parameters that must be selected
                                        
                                        Any valdityParameters and limitations listed here are in ADDITION to the ones specified in the Assignment
                                        
                                        -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:BusToBoatStartTime" version="1" order="1">
                                            <!-- Start time for bus to boat needs to be specified -->
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpecificationStartTimePolicyAssignment"/>
                                        </CustomerPurchaseParameterAssignment>
                                    </includes>

                                </CustomerPurchaseParameterAssignment>



                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:BusToBoat-Validity" order="1">
                                    <!-- This type defines the validable element parameters when access right is activated -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:BusToBoat"/>
                                
                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <InterchangingRef ref="ENT:Interchanging:None"/>
                                        <UserProfileRef ref="ENT:UserProfile:Adult" version="1"/>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                        <TariffZoneRef ref="ENT:TariffZone:A" version="1"/>
                                    </validityParameters>
                                </CustomerPurchaseParameterAssignment>

                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>

                        <!-- Boat leg -->
                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:Boat" version="1" order="1">

                       
                            <validityParameterAssignments>

                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Boat-Activation" order="1">

                                    <!-- This type defines uvp activation rules -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:Boat" version="1"/>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:X30kDays" version="1">
                                            <UsageTrigger>startOutboundRide</UsageTrigger>
                                            <UsageEnd>endOfRide</UsageEnd>
                                            <ActivationMeans>useOfMobileDevice useOfValidator</ActivationMeans>
                                            <StartDate>2021-01-01</StartDate>
                                            <EndDate>2022-01-01</EndDate>
                                        </UsageValidityPeriod>
                                    </limitations>

                                    <!-- 10 trips -->
                                    <MaximumNumberOfAccesses>
                                        <Type>limited</Type>
                                        <Value>10</Value>
                                    </MaximumNumberOfAccesses>
                                    
                                    <includes>
                                        <!-- Must select the service journey the ticket shall be valid on -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:BoatServiceJourneySelectionRequirement" version="1" order="1">
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpecificationServiceJourneyPolicyAssignment"/>
                                            <ValidityParameterGroupingType>OR</ValidityParameterGroupingType>
                                            <validityParameters>
                                                <LineRef ref="ENT:Line:BoatLine"/>
                                            </validityParameters>
                                        </CustomerPurchaseParameterAssignment>
                                    </includes>

                                </CustomerPurchaseParameterAssignment>




                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:Boat-Validity" order="1">
                                    <!-- This type defines the validable element parameters when access right is activated -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:Boat" version="1"/>
                                    
                                    <!-- start/stop pair of boat ride -->
                                    <DynamicDistanceMatrixElement id="ENT:DistanceMatrixElement:Boat" version="21">
                                        <StartStopPointRef ref="NSR:ScheduledStopPoint:S19923"/>
                                        <EndStopPointRef ref="NSR:ScheduledStopPoint:S55995"/>
                                    </DynamicDistanceMatrixElement>

                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <InterchangingRef ref="ENT:Interchanging:None"/>
                                        <UserProfileRef ref="ENT:UserProfile:Adult" version="1"/>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                    </validityParameters>
                                </CustomerPurchaseParameterAssignment>
                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>

                        <!-- Boat to bus -->
                        <CustomerPurchasePackageElement id="ENT:CustomerPurchasePackageElement:BusFromBoat" version="1" order="1">
                            
                            <!-- TODO Q1: How to define that CPPE is NOT consumable on its own? 
                            A: ActivationMeans = automaticByDependency-->
                            
                            <!-- TODO example element access -->
                            <elementAccesses>
                                
                            </elementAccesses>
                            
                            <validityParameterAssignments>
                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:BusFromBoat" order="1">
                                    <!-- This type defines uvp activation rules -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsagePolicyAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:BusFromBoat" version="1"/>
                                    
                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <UsageValidityPeriod id="ENT:UsageValidityPeriod:BusFromBoat" version="1">
                                            <UsageTrigger>specifiedStartDate</UsageTrigger>
                                            <UsageEnd>standardDuration</UsageEnd>
                                            <ActivationMeans>automaticByDependency</ActivationMeans>
                                           </UsageValidityPeriod>
                                    </limitations>
                                    
                                    <TimeIntervalRef ref="ENT:TimeInterval:45Minutes"/>


                                    <!-- 10 times -->
                                    <MaximumNumberOfAccesses>
                                        <Type>limited</Type>
                                        <Value>10</Value>
                                    </MaximumNumberOfAccesses>
                                    
                                    
                                    <includes>
                                        <!-- Parameters that must be selected
                                        
                                        Any valdityParameters and limitations listed here are in ADDITION to the ones specified in the Assignment
                                        
                                        -->
                                        <CustomerPurchaseParameterAssignment id="ENT:CustomerPurchaseParameterAssignment:BusFromBoatStartTime" version="1" order="1">
                                            <!-- Start time for bus to boat needs to be specified -->
                                            <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:SpecificationStartTimePolicyAssignment"/>
                                        </CustomerPurchaseParameterAssignment>
                                    </includes>
                                    
                                </CustomerPurchaseParameterAssignment>
                                
                                
                                
                                <CustomerPurchaseParameterAssignment version="1" id="ENT:CustomerPurchaseParameterAssignment:BusFromBoat-Validity" order="1">
                                    <!-- This type defines the validable element parameters when access right is activated -->
                                    <TypeOfAccessRightAssignmentRef ref="ENT:TypeOfAccessRightAssignment:ActivationAndUsageAssignment"/>
                                    <ValidableElementRef ref="ENT:ValidableElement:BusFromBoat"/>
                                    
                                    <LimitationGroupingType>AND</LimitationGroupingType>
                                    <limitations>
                                        <InterchangingRef ref="ENT:Interchanging:None"/>
                                        <UserProfileRef ref="ENT:UserProfile:Adult" version="1"/>
                                    </limitations>
                                    <ValidityParameterGroupingType>AND</ValidityParameterGroupingType>
                                    <validityParameters>
                                        <AuthorityRef ref="ENT:Authority:ENT" version="1"/>
                                        <TariffZoneRef ref="ENT:TariffZone:B" version="1"/>
                                    </validityParameters>
                                    
                                </CustomerPurchaseParameterAssignment>
                                
                            </validityParameterAssignments>
                        </CustomerPurchasePackageElement>
                        
                    </customerPurchasePackageElements>
                </CustomerPurchasePackage>
            </customerPurchasePackages>
        </SalesTransactionFrame>


    </dataObjects>
</PublicationDelivery>
